flows:
  get-source-messages:
    - log: "Preparing to perform a request to Source: ${replaySource.sourceUrl} for reprocessing messages ..."
    - script: groovy
      body: |
        
        @Grab('org.apache.kafka:kafka-clients:2.8.1')
        import org.apache.kafka.clients.consumer.KafkaConsumer
        
        def splitSource = replaySource.sourceUrl.split('://')
        def schema = splitSource[0]
  
        def topicDefinition = splitSource[1].split('/')[1]
        def topic = topicDefinition.split('?')[0]
        def consumerGroup = topicDefinition.split('?')[1]
  
        switch(schema) {
          case 'kafka':
            replayMessagesFromKafka(topic)
            break;
          case 'cosmosdb':
            println('Schema is of type Cosmos DB ....')
            break;
          default:
            println('Schema ' + schema + ' is not supported .....' )
            break;
        }
        
        
        def replayMessagesFromKafka(topic, consumerGroup) { 
          println('Retrieving message(s) from topic: ' + topic + ' with consumer group of ' + consumerGroup)
        }